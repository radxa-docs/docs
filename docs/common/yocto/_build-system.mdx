## 硬件要求

- 主机系统

推荐使用 Ubuntu 或 Windows (WSL2)。

- 32GB 及以上内存
- 90GB 及以上可用硬盘空间

:::tip Yocto 项目

Yocto 项目支持的 Linux 发行版：[参考链接](https://docs.yoctoproject.org/ref-manual/system-requirements.html#supported-linux-distributions)

:::

## 环境搭建

<NewCodeBlock tip={`radxa@${props?.board ?? 'device'}$`} type="device">

```
sudo apt-get update
sudo apt-get install \
    build-essential chrpath cpio debianutils diffstat file gawk gcc git \
    iputils-ping libacl1 liblz4-tool locales python3 python3-git \
    python3-jinja2 python3-pexpect python3-pip python3-subunit socat \
    texinfo unzip wget xz-utils zstd repo -y
```

</NewCodeBlock>

## 获取源码

<NewCodeBlock tip={`radxa@${props?.board ?? 'device'}$`} type="device">

```
mkdir ~/yocto-rockchip-sdk && cd ~/yocto-rockchip-sdk
repo init -u https://github.com/radxa/yocto-manifests.git -b scarthgap
repo sync
```

</NewCodeBlock>

## 链接配置文件

将 {props?.board ?? '主板'} 的配置文件链接到 `local.conf`。

<NewCodeBlock tip={`radxa@${props?.board ?? 'device'}$`} type="device">

```
cd ~/yocto-rockchip-sdk/build/conf
ln -sf rockchip-<soc>-<board>.conf local.conf
```

</NewCodeBlock>

{props?.board ?? '主板'} 链接示例：

<code>{`ln -sf ${
  props?.board_conf ?? "rockchip-<soc>-<board>.conf"
} local.conf`}</code>

## 开始构建

<NewCodeBlock tip={`radxa@${props?.board ?? 'device'}$`} type="device">

```
cd ~/yocto-rockchip-sdk
source ./oe-init-build-env
bitbake core-image-minimal
```

</NewCodeBlock>

构建成功后，会在 `~/yocto-rockchip-sdk/build/tmp/deploy/images/` 目录下生成 {props?.board ?? '主板'} 对应的镜像文件。

{props?.board ?? '主板'} 构建示例：

- <code>{`core-image-minimal-rockchip-${props?.soc ?? "<soc>"}-${
    props?.board_name ?? "<board_name>"
  }.rootfs.update.img`}</code>
- <code>{`core-image-minimal-rockchip-${props?.soc ?? "<soc>"}-${
    props?.board_name ?? "<board_name>"
  }.rootfs.wic`}</code>

其中 `*.rootfs.update.img` 文件为为 MicroSD 卡启动系统的镜像文件，`*.rootfs.wic` 文件为 eMMC 启动系统的镜像文件。

:::tip 常见问题

- `Please make sure locale 'en_US.UTF-8' is available on your system`

若系统中没有 `en_US.UTF-8`，则需要按照下面步骤设置：

<NewCodeBlock tip={`radxa@${props?.board ?? 'device'}$`} type="device">

```
sudo apt install locales
sudo locale-gen en_US en_US.UTF-8
sudo update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8
sudo echo "export LANG=en_US.UTF-8" >> ~/.bashrc
source ~/.bashrc
```

</NewCodeBlock>

:::
