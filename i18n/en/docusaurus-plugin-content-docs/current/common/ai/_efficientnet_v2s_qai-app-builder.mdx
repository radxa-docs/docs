This document describes using the [QAI AppBuilder](../qai-appbuilder) Python API to perform inference with the [EfficientNet-V2-s](https://aihub.qualcomm.com/models/efficientnet_v2_s)
target recognition model using Qualcomm® Hexagon™ Processor (NPU).

**Supported Devices**

| Device     | SoC     |
| ---------- | ------- |
| Dragon Q6A | QCS6490 |

## Install QAI AppBuilder

:::tip

1. Please install QAI AppBuilder according to [**QAI AppBuilder Installation Guide**](../qai-appbuilder#installation-methods).

2. Please configure QAIRT environment variables according to [**Configure QAIRT Environment Variables**](../qai-appbuilder#configure-qairt-environment-variables).
   :::

## Run Example

### Install Dependencies

<NewCodeBlock tip="Device" type="device">

```bash
pip3 install requests tqdm qai-hub py3_wget opencv-python torch torchvision
```

</NewCodeBlock>

### Run Script

- Navigate to the example directory

    <Tabs>

        <TabItem value="QCS6490">

       <NewCodeBlock tip="Device" type="device">

         ```bash
         cd ai-engine-direct-helper/samples/linux/python
         ```

        </NewCodeBlock>

    </TabItem>

    </Tabs>

- Prepare input image, using the following image as input example

  {" "}

  <div style={{ textAlign: "center" }}>
    <img src="/en/img/dragon/q6a/test_image.webp" style={{ width: "65%" }} />
    input image
  </div>

- Execute inference

    <NewCodeBlock tip="Device" type="device">

  ```bash
  python3 efficientnet_v2_s/efficientnet_v2_s.py
  ```

    </NewCodeBlock>

  ```bash
  $ python3 efficientnet_v2_s/efficientnet_v2_s.py
  Current file directory: /mnt/ssd/qualcomm/701/zzf_fork/ai-engine-direct-helper/samples/linux/python/efficientnet_v2_s
       0.0ms [WARNING]  <W> Initializing HtpProvider

  /prj/qct/webtech_scratch20/mlg_user_admin/qaisw_source_repo/rel/qairt-2.37.1/point_release/SNPE_SRC/avante-tools/prebuilt/dsp/hexagon-sdk-5.4.0/ipc/fastrpc/rpcmem/src/rpcmem_android.c:38:dummy call to rpcmem_init, rpcmem APIs will be used from libxdsprpc
       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

     129.0ms [WARNING] Time: Read model file to memory. 11.18

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

     158.9ms [WARNING] Time: contextCreateFromBinary. 29.89

     159.0ms [WARNING] Time: UnmapViewOfFile. 0.00

     159.4ms [WARNING] Time: model_initialize efficientnet_v2_s 159.34

     227.4ms [WARNING] Time: model_inference efficientnet_v2_s 10.06

  Top 5 predictions for image:

  Samoyed 0.7607400417
  keeshond 0.0230328161
  Pomeranian 0.0204458293
  white wolf 0.0193288065
  Arctic fox 0.0062915389
       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

       0.0ms [WARNING]  <W> This META does not have Alloc2 Support

  /prj/qct/webtech_scratch20/mlg_user_admin/qaisw_source_repo/rel/qairt-2.37.1/point_release/SNPE_SRC/avante-tools/prebuilt/dsp/hexagon-sdk-5.4.0/ipc/fastrpc/rpcmem/src/rpcmem_android.c:42:dummy call to rpcmem_deinit, rpcmem APIs will be used from libxdsprpc
     239.8ms [WARNING] Time: model_destroy efficientnet_v2_s 9.40
  ```

  The printed results show that `Samoyed` has the highest confidence, which matches the input image content.
